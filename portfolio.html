<script>
    // Мобильное меню
    document.querySelector('.nav-toggle').addEventListener('click', function() {
        const navMenu = document.querySelector('.nav-menu');
        navMenu.classList.toggle('active');
        
        // Закрываем меню после клика по ссылке
        const navLinks = document.querySelectorAll('.nav-menu a');
        navLinks.forEach(link => {
            link.addEventListener('click', function() {
                navMenu.classList.remove('active');
            });
        });
    });

    // Папки портфолио
    function toggleFolder(folderId) {
        const folder = document.getElementById(folderId);
        const content = folder.querySelector('.folder-content');
        const arrow = folder.querySelector('.folder-arrow');
        
        // Закрываем все другие папки
        document.querySelectorAll('.folder-content').forEach(item => {
            if (item !== content) {
                item.classList.remove('active');
            }
        });
        document.querySelectorAll('.folder-arrow').forEach(item => {
            if (item !== arrow) {
                item.classList.remove('active');
            }
        });
        
        // Переключаем текущую папку
        content.classList.toggle('active');
        arrow.classList.toggle('active');
    }

    // Lightbox
    let currentCategory = '';
    let currentIndex = 0;

    const maxImages = {
        'family': 33,
        'product': 99,
        'macro': 18,
        'newborn': 12,
        'story': 13
    };

    function openLightbox(category, index) {
        currentCategory = category;
        currentIndex = index;
        document.getElementById('lightbox-image').src = `images/${category}/${category}-${index}.jpg`;
        document.getElementById('lightbox').style.display = 'flex';
        document.body.style.overflow = 'hidden';
    }

    function closeLightbox() {
        document.getElementById('lightbox').style.display = 'none';
        document.body.style.overflow = 'auto';
    }

    function changeImage(direction) {
        currentIndex += direction;
        
        if (currentIndex < 1) currentIndex = maxImages[currentCategory];
        if (currentIndex > maxImages[currentCategory]) currentIndex = 1;
        
        document.getElementById('lightbox-image').src = `images/${currentCategory}/${currentCategory}-${currentIndex}.jpg`;
    }

    // Закрытие lightbox по клику вне изображения
    document.getElementById('lightbox').addEventListener('click', function(e) {
        if (e.target === this) {
            closeLightbox();
        }
    });

    // Управление клавиатурой
    document.addEventListener('keydown', function(e) {
        if (document.getElementById('lightbox').style.display === 'flex') {
            if (e.key === 'Escape') closeLightbox();
            if (e.key === 'ArrowLeft') changeImage(-1);
            if (e.key === 'ArrowRight') changeImage(1);
        }
    });

    // Открываем папку из хеша URL
    window.addEventListener('load', function() {
        const hash = window.location.hash.substring(1);
        if (hash && document.getElementById(hash)) {
            toggleFolder(hash);
            setTimeout(() => {
                document.getElementById(hash).scrollIntoView({ behavior: 'smooth' });
            }, 100);
        }
    });

    // Закрытие мобильного меню при клике вне его
    document.addEventListener('click', function(e) {
        const navMenu = document.querySelector('.nav-menu');
        const navToggle = document.querySelector('.nav-toggle');
        
        if (navMenu.classList.contains('active') && 
            !navMenu.contains(e.target) && 
            !navToggle.contains(e.target)) {
            navMenu.classList.remove('active');
        }
    });
</script>
